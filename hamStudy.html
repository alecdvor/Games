<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amateur Radio General Exam Study Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation;
        }
        .option-btn {
            transition: background-color 0.2s ease-in-out, transform 0.1s ease;
        }
        .option-btn:active {
            transform: scale(0.98);
        }
        .correct {
            background-color: #22c55e !important; /* Tailwind green-500 */
            color: white !important;
        }
        .incorrect {
            background-color: #ef4444 !important; /* Tailwind red-500 */
            color: white !important;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 flex items-center justify-center min-h-screen p-4">

    <div id="game-container" class="w-full max-w-2xl mx-auto bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 md:p-8">
        <h1 class="text-2xl md:text-3xl font-bold text-center text-gray-800 dark:text-white mb-2">General Class Exam Prep</h1>
        <p id="progress-text" class="text-center text-gray-500 dark:text-gray-400 mb-6">Question 1 of 514</p>

        <!-- Image container -->
        <div id="image-container" class="mb-6 text-center">
            <img id="question-image" src="" alt="Question Figure" class="max-w-full h-auto mx-auto rounded-lg shadow-md hidden">
        </div>

        <div id="question-container">
            <p id="question-id" class="text-sm font-semibold text-blue-600 dark:text-blue-400 mb-2"></p>
            <p id="question-text" class="text-lg md:text-xl font-medium mb-6"></p>
        </div>

        <div id="options-container" class="space-y-4">
            <!-- Options will be dynamically inserted here -->
        </div>

        <div class="mt-8 text-center">
            <button id="next-btn" class="w-full sm:w-auto bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 dark:focus:ring-blue-800 transition-all duration-300 disabled:bg-gray-400 dark:disabled:bg-gray-600 disabled:cursor-not-allowed">
                Next Question
            </button>
        </div>
    </div>

    <!-- Chapter Question Files -->
    <script src="study/g1_questions.js"></script>
    <script src="study/g2_questions.js"></script>
    <script src="study/g3_questions.js"></script>
    <script src="study/g4_questions.js"></script>
    <script src="study/g5_questions.js"></script>
    <script src="study/g6_questions.js"></script>
    <script src="study/g7_questions.js"></script>
    <script src="study/g8_questions.js"></script>
    <script src="study/g9_questions.js"></script>
    <script src="study/g0_questions.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // NOTE: The variable names (chapter1, chapter2, etc.) are defined inside the loaded JS files.
            // They must match what's in those files, regardless of the filename.
            const allChapters = [chapter1, chapter2, chapter3, chapter4, chapter5, chapter6, chapter7, chapter8, chapter9, chapter10];
            const allQuestions = allChapters.flatMap(chapter => chapter.questions);
            const totalQuestions = allQuestions.length;

            let currentQuestionIndex = 0;
            let optionsDisabled = false;

            const progressText = document.getElementById('progress-text');
            const questionIdText = document.getElementById('question-id');
            const questionText = document.getElementById('question-text');
            const optionsContainer = document.getElementById('options-container');
            const nextBtn = document.getElementById('next-btn');
            const questionImage = document.getElementById('question-image');

            function displayQuestion(index) {
                optionsDisabled = false;
                const question = allQuestions[index];

                // Update text content
                progressText.textContent = `Question ${index + 1} of ${totalQuestions}`;
                questionIdText.textContent = `ID: ${question.id}`;
                questionText.textContent = question.question;

                // Clear previous options
                optionsContainer.innerHTML = '';

                // Display options
                question.options.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.classList.add('option-btn', 'w-full', 'text-left', 'p-4', 'rounded-lg', 'border', 'border-gray-300', 'dark:border-gray-600', 'bg-gray-50', 'dark:bg-gray-700', 'hover:bg-gray-200', 'dark:hover:bg-gray-600');
                    button.addEventListener('click', () => handleOptionClick(button, option, question.answer));
                    optionsContainer.appendChild(button);
                });

                // Handle image display
                if (question.image) {
                    questionImage.src = question.image;
                    questionImage.alt = `Figure for question ${question.id}`;
                    questionImage.classList.remove('hidden');
                } else {
                    questionImage.classList.add('hidden');
                }

                // Disable Next button
                nextBtn.disabled = true;
            }

            function handleOptionClick(button, selectedOption, correctAnswer) {
                if (optionsDisabled) return;
                optionsDisabled = true;

                const optionButtons = optionsContainer.querySelectorAll('.option-btn');
                
                if (selectedOption === correctAnswer) {
                    button.classList.add('correct');
                } else {
                    button.classList.add('incorrect');
                    // Highlight the correct answer
                    optionButtons.forEach(btn => {
                        if (btn.textContent === correctAnswer) {
                            btn.classList.add('correct');
                        }
                    });
                }
                nextBtn.disabled = false;
            }

            nextBtn.addEventListener('click', () => {
                currentQuestionIndex++;
                if (currentQuestionIndex < totalQuestions) {
                    displayQuestion(currentQuestionIndex);
                } else {
                    // Game over, show summary or restart
                    questionText.textContent = "Congratulations! You've completed all questions.";
                    optionsContainer.innerHTML = '';
                    progressText.textContent = `Completed ${totalQuestions} of ${totalQuestions}`;
                    questionIdText.textContent = 'Finished!';
                    nextBtn.textContent = 'Restart';
                    nextBtn.onclick = () => {
                        currentQuestionIndex = 0;
                        displayQuestion(currentQuestionIndex);
                        nextBtn.textContent = 'Next Question';
                        nextBtn.onclick = nextButtonClickHandler; // re-assign original handler
                    };
                }
            });
            
            // Store the original click handler to re-assign it on restart
            const nextButtonClickHandler = nextBtn.onclick;

            // Start the game
            displayQuestion(currentQuestionIndex);
        });
    </script>
</body>
</html>